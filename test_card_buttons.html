<!DOCTYPE html>
<html>
<head>
    <title>Card Button Test</title>
</head>
<body>
    <h2>AEK Cards</h2>
    <div>
        <label>Yellow AEK:</label>
        <button type="button" class="card-btn card-btn-down" data-target="yellowa" data-min="0">−</button>
        <input type="number" min="0" name="yellowa" value="0" readonly>
        <button type="button" class="card-btn card-btn-up" data-target="yellowa" data-max="20">+</button>
    </div>
    <div>
        <label>Red AEK:</label>
        <button type="button" class="card-btn card-btn-down" data-target="reda" data-min="0">−</button>
        <input type="number" min="0" name="reda" value="0" readonly>
        <button type="button" class="card-btn card-btn-up" data-target="reda" data-max="11">+</button>
    </div>

    <h2>Real Cards</h2>
    <div>
        <label>Yellow Real:</label>
        <button type="button" class="card-btn card-btn-down" data-target="yellowb" data-min="0">−</button>
        <input type="number" min="0" name="yellowb" value="0" readonly>
        <button type="button" class="card-btn card-btn-up" data-target="yellowb" data-max="20">+</button>
    </div>
    <div>
        <label>Red Real:</label>
        <button type="button" class="card-btn card-btn-down" data-target="redb" data-min="0">−</button>
        <input type="number" min="0" name="redb" value="0" readonly>
        <button type="button" class="card-btn card-btn-up" data-target="redb" data-max="11">+</button>
    </div>

    <script>
    function setupCardButtons() {
        console.log('Setting up card buttons...');
        document.querySelectorAll('.card-btn-up').forEach(btn => {
            console.log('Found up button with target:', btn.getAttribute('data-target'));
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                const target = e.currentTarget.getAttribute('data-target');
                const max = parseInt(e.currentTarget.getAttribute('data-max')) || 99;
                const input = document.querySelector(`input[name="${target}"]`);
                console.log('Up button clicked - target:', target, 'input found:', input);
                if (input) {
                    const current = parseInt(input.value) || 0;
                    if (current < max) {
                        input.value = current + 1;
                        console.log('Updated input', target, 'to', current + 1);
                    }
                }
            });
        });
        document.querySelectorAll('.card-btn-down').forEach(btn => {
            console.log('Found down button with target:', btn.getAttribute('data-target'));
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                const target = e.currentTarget.getAttribute('data-target');
                const min = parseInt(e.currentTarget.getAttribute('data-min')) || 0;
                const input = document.querySelector(`input[name="${target}"]`);
                console.log('Down button clicked - target:', target, 'input found:', input);
                if (input) {
                    const current = parseInt(input.value) || 0;
                    if (current > min) {
                        input.value = current - 1;
                        console.log('Updated input', target, 'to', current - 1);
                    }
                }
            });
        });
    }

    // Test the setup - simulate multiple calls
    setupCardButtons();
    setupCardButtons(); // Second call - this might cause the issue!
    
    // Add a button to test calling setupCardButtons multiple times
    const testBtn = document.createElement('button');
    testBtn.textContent = 'Call setupCardButtons again';
    testBtn.onclick = setupCardButtons;
    document.body.appendChild(testBtn);
    </script>
</body>
</html>